till now, complete pipeline with automation
for all states and optimization
added recovery